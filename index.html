<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Company Review</title>
    <link href="css/materialize.css" rel="stylesheet">
    <link href="css/screen.css" rel="stylesheet">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="msapplication-tap-highlight" content="no">
</head>
<body>
<main>
    <div class="section" id="index-banner">
        <div class="container">
            <div class="row">
                <div class="col s12">
                    <h4 class="light center-on-small-only" v-show="start == '0' ">
                        看看你所在的创业公司能打几分？</h4>

                    <div class="row" v-show="start == '1' ">
                        <h4 class="header center-on-small-only col s12">
                            {{question[number].questionText}}</h4>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="section" id="button">
        <div class="container center-align">
            <a class="waves-effect waves-light btn-large " v-show="start == '0' " v-on="click:startTest() ">Start</a>
            <div class="row" v-show="start === '1' ">
                <a class="waves-effect waves-light green darken-3 btn-large" v-on="click:choose(true)">是</a>
                <a class="waves-effect waves-light cyan  darken-3 btn-large" v-on="click:choose(false)">否</a>
                <div class="progress">
                    <div class="determinate" v-style="width: number*100/question.length + '%'"></div>
                </div>
            </div>
        </div>
    </div>
    <div id="answer" class="container row" v-show="start === '2' ">
        <div class="col s12">
            <div class="card">
                <div class="card-content">
                    <h4>结果解读</h4>
                    <p>{{answer}}</p>
                    <div class="input-field">
                        <input id="first_name" type="text" class="validate" v-model="companyName">
                        <label for="first_name">公司的名称</label>
                        <a class="waves-effect waves-light green darken-3 btn white-text" v-on="click:makeShareLink()">填写公司名称生成分享链接</a>
                        <p>{{shareLink}}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
        <div id="score" class="card blue-grey darken-1" v-show="start !== '0' ">
            <div class="card-content white-text center-align">
                <span class="card-title ">{{score}}</span>
            </div>
        </div>

</main>
<script src="js/jquery.js"></script>
<script src="js/materialize.min.js"></script>
<script src="js/vue.js"></script>
<script src="js/question.js"></script>
<script>
    var vm = new Vue({
        el: 'body',
        data: {
            start: '0',
            questionText: '',
            question: question,
            number: 0,
            score: 0,
            answer: '',
            companyName :'',
            shareLink:''
        },
        filters: {
        },
        methods: {
            startTest: function () {
                vm.$data.start = '1';
            },
            choose: function (choose) {
                if (choose == true) {
                        vm.$data.score += vm.$data.question[vm.$data.number].score;
                        vm.$data.questionText += '1';
                    }else{
                        vm.$data.questionText += '0';
                }
                if (vm.$data.number == vm.$data.question.length - 1) {
                    vm.$data.start = '2';
                    console.info(vm.$data.questionText);
                    this.getAnswer();
                } else {
                    console.info(vm.$data.number + '  ' + vm.$data.question.length);
                    vm.$data.number += 1;
                }
            },
            getAnswer : function(){
                var score = vm.$data.score;
                for(var i= answer.length - 1;i >= 0;i--){
                    if(score <= answer[i].score){
                        vm.$data.answer = answer[i].answer;
                    }
                }
            },
            makeShareLink : function(){
                var url = window.location.href;
                var que = url.indexOf('?');
                var host = url.substr(0,que);
                var shareLink = host+'?name='+vm.$data.companyName+'&question='+vm.$data.questionText;

            }
        }
    });
</script>
</body>
</html>